{"version":3,"file":"static/chunks/pages/index-bb19bd52113e6d30.js","mappings":"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","sources":["webpack://_N_E/","webpack://_N_E/./src/utils/numbers.ts","webpack://_N_E/./src/utils/http.ts","webpack://_N_E/./src/components/TaxCalculator/taxCalculatorApi.ts","webpack://_N_E/./src/components/TaxCalculator/taxCalculatorUtils.ts","webpack://_N_E/./src/components/TaxCalculator/TaxCalculatorTable/TaxCalculatorTable.tsx","webpack://_N_E/./src/components/TaxCalculator/TaxCalculatorTable/index.ts","webpack://_N_E/./src/components/TaxCalculator/TaxCalculator.tsx","webpack://_N_E/./src/components/TaxCalculator/index.ts","webpack://_N_E/./src/pages/index.tsx","webpack://_N_E/./src/components/TaxCalculator/TaxCalculatorTable/taxCalculatorTable.module.scss","webpack://_N_E/./src/components/TaxCalculator/taxCalculator.module.scss","webpack://_N_E/<anon>"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/\",\n      function () {\n        return require(\"private-next-pages/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/\"])\n      });\n    }\n  ","export const round = (num: number, decimals: number = 2) => {\n  const roundPrecision = Math.pow(10, decimals);\n  return Math.round(num * roundPrecision) / roundPrecision;\n}\n\nexport const formatCurrency = (num?: number, decimals: number = 0) => {\n  if (num === undefined) {\n    return '';\n  }\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    maximumFractionDigits: decimals,\n    minimumFractionDigits: decimals,\n  }).format(num);\n}\n","import axios from 'axios';\nimport { useState } from 'react';\n\nexport const http = axios.create({\n  baseURL: 'http://localhost:5000',\n});\n\ntype PromiseFuction<T> = (...args: any[]) => Promise<T>;\nexport function useApi<T extends any = any, Fetcher extends PromiseFuction<T> = PromiseFuction<T>>(fetcher: Fetcher) {\n  const [isLoading, setIsLoading] = useState(false);\n  const [hasError, setHasError] = useState(false);\n  const [data, setData] = useState<T | undefined>();\n  const run = (...args: any[]) => {\n    setIsLoading(true);\n    setHasError(false);\n    setData(undefined);\n    return (fetcher as any)(...args).then((response: any) => {\n      setData(response);\n      return response;\n    }).catch((err: any) => {\n      setHasError(true);\n    }).finally(() => {\n      setIsLoading(false);\n    });\n  };\n  \n  return {\n    run: run as Fetcher,\n    isLoading,\n    hasError,\n    data,\n  };\n};\n","import { http } from '@/utils/http'\nimport { TaxBracket } from './taxCalculatorTypes';\nimport { queryClient } from '@/utils/reactQuery';\nimport { sprintf } from 'sprintf-js';\n\ninterface TaxBracketsResponse {\n  tax_brackets: TaxBracket[];\n}\n\n/**\n * I like to define API routes in respective file instead of central api routes file.\n * This makes code navigation and refactoring easy\n */\nconst API = {\n  TAX_RATES: 'tax-calculator/tax-year/%(assessmentYear)s',\n}\n\nexport const fetchTaxRates = (assessmentYear: number) => {\n  return queryClient.fetchQuery<TaxBracket[]>(['taxBrackets', assessmentYear], async () => {\n    const response = await http.get<TaxBracketsResponse>(sprintf(API.TAX_RATES, { assessmentYear }));\n    return response.data.tax_brackets;\n  });\n};\n","import { round } from '@/utils/numbers';\nimport { TaxInBand } from './taxCalculatorTypes';\nimport { fetchTaxRates } from './taxCalculatorApi';\n\nexport const getCalculatedTax = async (annualIncome: number, assessmentYear: number) => {\n  let totalTax = 0;\n  const taxRates = await fetchTaxRates(assessmentYear);\n  const taxBands: TaxInBand[] = [];\n  let remainingIncome = annualIncome;\n\n  for (const taxRate of taxRates) {\n    if (annualIncome < taxRate.min) {\n      break;\n    }\n\n    const taxBandMax = Math.min(remainingIncome, taxRate.max || Infinity);\n    const taxBandMin = taxRate.min;\n    const taxableIncomeInBand = taxBandMax - taxBandMin;\n\n    const tax = taxRate.rate * taxableIncomeInBand;\n\n    totalTax += tax;\n    taxBands.push({...taxRate, tax: round(tax, 2)});\n  }\n\n  return {\n    totalTax: round(totalTax, 2),\n    taxBands\n  }\n}\n\nexport const validateAnnualIncome = (annualIncome: number) => {\n  if (annualIncome <= 0) {\n    return 'Annual income must be greater than 0';\n  }\n}\n","import { FunctionComponent } from \"react\";\nimport styles from './taxCalculatorTable.module.scss';\nimport { formatCurrency } from \"@/utils/numbers\";\nimport { TaxInBand } from \"../taxCalculatorTypes\";\n\ninterface TaxCalculatorTableProps {\n  totalTax: number;\n  taxBands: TaxInBand[];\n  annualIncome: number;\n}\nexport const TaxCalculatorTable: FunctionComponent<TaxCalculatorTableProps> = (props) => {\n  return props.taxBands ? <div className={styles.taxCalculationContainer}>\n    <div className={styles.taxCalculationSummary}>\n      <div className={styles.taxCalculationSummaryTitle}>\n        Total Tax (for {formatCurrency(props.annualIncome)})\n      </div>\n      <div className={styles.taxCalculationSummaryValue}>\n        {formatCurrency(props.totalTax)}\n      </div>\n    </div>\n    <table className={styles.taxCalculationTable}>\n      <tbody>\n        {props.taxBands.map((taxRate) => (\n          <tr key={taxRate.min}>\n            <td>\n              <div>\n                {formatCurrency(taxRate.min || 0)} - {taxRate.max ? formatCurrency(taxRate.max) : 'any'}\n              </div>\n              <div className=\"text-hint text-small\">{`${(taxRate.rate * 100).toFixed(1)}%`}</div>\n            </td>\n            <td className={styles.taxNumber}>\n              {formatCurrency(taxRate.tax)}\n            </td>\n          </tr>\n        ))}\n      </tbody>\n      <tr className={styles.tableFooter}>\n        <td>Total</td>\n        <td className={styles.taxNumber}>\n          {formatCurrency(props.totalTax)}\n        </td>\n      </tr>\n    </table>\n  </div> : null;\n}\n","export * from './TaxCalculatorTable';\n","import { Button, FormControl, InputLabel, MenuItem, Select, TextField } from '@mui/material'\nimport { FunctionComponent, useEffect, useState } from 'react'\nimport { useForm } from 'react-hook-form';\nimport { getCalculatedTax, validateAnnualIncome } from './taxCalculatorUtils';\nimport { useApi } from '@/utils/http';\nimport { TaxCalculatorTable } from './TaxCalculatorTable';\nimport styles from './taxCalculator.module.scss';\n\nconst ASSESSMENT_YEAR = [2022, 2021, 2020, 2019];\n\ninterface TaxCalculatorFormFields {\n  assessmentYear: number;\n  annualIncome: number;\n}\nexport const TaxCalculator: FunctionComponent = () => {\n  const { register, handleSubmit, getValues, formState: { errors } } = useForm<TaxCalculatorFormFields>();\n  const { run: apiGetCalculatedTax, data: calculatedTax, isLoading, hasError } = useApi(getCalculatedTax);\n  const isFormValid = Object.keys(errors).length === 0;\n\n  const onSubmit = async (data: TaxCalculatorFormFields) => {\n    return await apiGetCalculatedTax(data.annualIncome, data.assessmentYear);\n  };\n\n  return (\n    <div className={styles.taxCalculatorContainer}>\n      <div className={styles.taxCalculatorContent}>\n        <h1>Tax Calculator</h1>\n        {/* If there are multiple usecases of forms, this can be improved to have less boilerplate code, and improve readibility */}\n        <form onSubmit={handleSubmit(onSubmit)} className={styles.taxCalculatorForm}>\n          <FormControl fullWidth>\n            <InputLabel htmlFor=\"assessmentYear\">Assessment Year</InputLabel>\n            <Select\n              aria-label=\"Assessment Year\"\n              label=\"Assessment Year\"\n              id=\"assessmentYear\"\n              defaultValue={2022}\n              {...register('assessmentYear', {valueAsNumber: true})}\n            >\n              {ASSESSMENT_YEAR.map((year) => <MenuItem key={year} value={year}>{year}</MenuItem>)}\n            </Select>\n          </FormControl>\n          <TextField\n            label=\"Annual Income\"\n            fullWidth\n            {...register('annualIncome', {\n              valueAsNumber: true,\n              validate: validateAnnualIncome,\n            })}\n            error={!!errors.annualIncome}\n            helperText={errors.annualIncome?.message}\n          />\n          <Button type=\"submit\" variant=\"contained\" disabled={isLoading || !isFormValid}>Calculate</Button>\n        </form>\n        {/* Error can be shown more beautifully */}\n        {hasError && <div className={styles.taxCalculatorError}>An Error occurred!</div>}\n        <TaxCalculatorTable\n          annualIncome={getValues('annualIncome')}\n          taxBands={calculatedTax?.taxBands}\n          totalTax={calculatedTax?.totalTax}\n        />\n      </div>\n    </div>\n  )\n}\n","/**\n * EXPLAINATION\n * I like to export all externally required components in index files\n * This makes the imports tidy.\n * In addition to this, I avoid default exports, as default exports puts it on individual developer to use considtent import names.\n * It can introduce some typos making refactoring difficult in future.\n * Named exports enforce consistent import names across the project.\n * \n * I avoid adding any \"actual\" code in index files, as navigating index files in a project can be tedious.\n */\nexport * from './TaxCalculator';\n","import { TaxCalculator } from '@/components/TaxCalculator';\n\nexport default function Home() {\n  return <TaxCalculator />;\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"taxCalculationContainer\":\"taxCalculatorTable_taxCalculationContainer__zSZU0\",\"heightAnimation\":\"taxCalculatorTable_heightAnimation___cRvi\",\"taxCalculationSummary\":\"taxCalculatorTable_taxCalculationSummary__KcxiZ\",\"taxCalculationSummaryTitle\":\"taxCalculatorTable_taxCalculationSummaryTitle__k125i\",\"taxCalculationSummaryValue\":\"taxCalculatorTable_taxCalculationSummaryValue__Gt621\",\"taxCalculationTable\":\"taxCalculatorTable_taxCalculationTable__g51ys\",\"tableFooter\":\"taxCalculatorTable_tableFooter__lVklW\",\"taxNumber\":\"taxCalculatorTable_taxNumber__TKW9Y\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"taxCalculatorContainer\":\"taxCalculator_taxCalculatorContainer__qF1Ci\",\"taxCalculatorContent\":\"taxCalculator_taxCalculatorContent__nex9N\",\"taxCalculatorForm\":\"taxCalculator_taxCalculatorForm__NG1ud\"};"],"names":["window","__NEXT_P","push","__webpack_require__","round","num","decimals","roundPrecision","Math","pow","formatCurrency","undefined","Intl","NumberFormat","style","currency","maximumFractionDigits","minimumFractionDigits","format","http","axios","baseURL","API","TAX_RATES","fetchTaxRates","queryClient","assessmentYear","response","sprintf","data","tax_brackets","getCalculatedTax","annualIncome","totalTax","taxRates","taxBands","taxRate","min","taxBandMax","max","Infinity","taxBandMin","taxableIncomeInBand","tax","rate","validateAnnualIncome","TaxCalculatorTable","props","jsx_runtime","jsxs","div","className","styles","jsx","table","tbody","map","tr","td","concat","toFixed","ASSESSMENT_YEAR","TaxCalculator","errors","register","handleSubmit","getValues","formState","useForm","run","apiGetCalculatedTax","calculatedTax","isLoading","hasError","useApi","fetcher","setIsLoading","useState","setHasError","setData","args","then","catch","finally","isFormValid","Object","keys","length","onSubmit","h1","form","FormControl","fullWidth","InputLabel","htmlFor","Select","aria-label","label","id","defaultValue","valueAsNumber","MenuItem","value","year","TextField","validate","error","helperText","message","Button","type","variant","disabled","Home","module","exports"],"sourceRoot":""}